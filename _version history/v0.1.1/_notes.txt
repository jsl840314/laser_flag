Version History:
    v0.0.0  02/08/2023  map-loading and movement rules complete
    v0.0.1  02/08/2023  refactored a bunch of shit
    v0.0.2  02/09/2023  a bit more refactoring; fixed a bug with climbing units
    v0.1.0  02/10/2023  implemented basic line-of-sight; still buggy
    v0.1.1  02/10/2023  line-of-sight seems to be working properly

################################################################################
ROADMAP:
################################################################################

Need a function for detecting line-rect collisions:
    need a list of all tiles the line passes through
    if any of these tiles walls the line is invalid

Repeat that function for these 7 lines:
    nearest corner to nearest corner
    nearest corner to wing 1
    nearest corner to wing 2
    wing 1 to wing 1
    wing 2 to wing 2
    wing 1 to wing 2
    wing 2 to wing 1

    terminate once a valid line is found; LOS is established
    if no valid lines, no LOS

    after each move, do this from each unit.rect to each
       enemy unit.rect and base.rect
       if cardinal direction: just check all tiles between
       else: check all tiles in the smallest box containing both tiles

    to display LOS, would need to do this for every non-wall tile
        - try implementing it and see if it can be done quickly
        - would be nice to either:
            implement fog-of-war (not very boardgame-like though)
            or show overwatch fields


Maybe: animate laser shots

Maybe: add sounds and music
    Mickey and Jeremy Ensley and Eric Morin help?

Need to clean up all images:
    remove tile edges on right and bottom of everything except walls
    adjust everything down to 39x39 except wall and floor
    make new 40x40 floor image, rotate randomly after loading:
        rotation = choice([0, 90, 180, 270])
        image = pygame.transform.rotate(image, rotation)

Need to allow for various map sizes & shapes
    max 21 tiles
    min needs to be play tested, maybe 11

Need to implement scoring & victory conditions

Need to expand map format to include scoring & victory

Need to build a map editor
Need a main menu / map loader
     - maybe use tkinter for these?


################################################################################
RULES:
################################################################################

Players take turns moving teams of units. Each unit can move around the
map and fire his laser. Each turn a unit may perform 3 actions, but firing
ends his turn (with exceptions). Soldiers move upon a grid and take up one grid
square each.

A unit that has been hit has his laser gun deactivated and must touch home base
to recharge his laser. Charging begins automatically; however, the unit must
wait until the next turn to fire again.
    - if the map does not include a base for that unit's team, the unit is
        eliminated from the game and removed from the board

Three possible game modes depending on the map:

    Capture the Flag: each team has at least one base
    Victory conditions: first to a set score AND/OR
                        highest score after set number of turns

    Assault: only one team has a base
    Victory conditions:  Capture the Flag victory conditions AND/OR:
                            team with no base is on offense
                            other team is on defense
                            offense tries to score as many points
                                as possible before all their units
                                are eliminated

    Elimination: no bases on the map
    Victory conditions: Capture the Flag victory conditions AND/OR:
                            last man standing wins

Map data will include turn limits and target scores
    - maps can be asymmetrical, so allow different target scores per team



Line-of-sight rules:
    If a line can be drawn from any part of a unit's square to any part of a
    target tile, without a wall blocking it, then the unit can hit that tile
    with his laser.

 (tentative algorithm):
    create 25 lines:
        from shooter's 4 corners and center to target's 4 corners and center
        if any line does not collide with a wall, LOS is established
    BASES hang from the ceiling and do not block any LOS


Soldiers can be one of three classes:
    SCOUTS can move quickly but are poor shooters       (+1 move, -1 attack)
    SNIPERS are slow movers but excellent shooters      (-1 move, +1 attack)
    GRUNTS are in between, but are better at defense    (+1 cover bonus)

    MOVEMENT RULES:
        each unit gets 3 AP (action points) per turn (move or fire):
            GRUNT turn ends after firing once
            SCOUT may fire once and keep moving
            SNIPER moves and fires like a Grunt, except:
              may fire a second time if he has not moved this turn
                however, firing once cancels chance to enter overwatch
        each class moves at different speeds:
            GRUNT can move 5 squares per AP
            SNIPER can move 4
            SCOUT can move 6

        units can move diagonally but may not pass a wall corner
            diagonal motion is not inhibited by corners of cover or other units

OVERWATCH:
    a unit enters overwatch mode if he has APs remaining and has not fired:
        allows 1 reaction shot against the 1st enemy troop who lands in his LOS
    snap shot mode if he has 1 AP left: -1 attack penalty
    regular mode if he has 2 or 3 AP left: normal attack


TERRAIN:
    a grid, maximum side 21x21 tiles, the squares of which can be:
        open terrain : the surface on which units move.
        walls        : stop unit movement and line-of-sight
        cover        : slow unit movement but not line-of-sight
                       requires remainder of AP to climb

TACTICAL POSITIONS:
    a unit is IN COVER against an enemy unit if:
        on level ground, adjacent to a cover square OR
        on any ground, adjacent to a wall:
            he is IN COVER against any attacks that come from that side
    a unit is ELEVATED if he is on top of a cover object

    a unit IN COVER has a +2 defensive bonus
        a grunt in cover has a +3 defensive bonus
    a unit ELEVATED has a +1 attack bonus but a -2 defensive penalty


HIT DICE:
    roll 2D6 to determine hits
    base to-hit: must roll 7 or greater

        note: the enemy base is considered ELEVATED ground (-2 defense penalty)
        for hit calculations


################################################################################
ROLL CHARTS:
################################################################################

roll 2D6
   2 :   1/36     36/36     100% will be greater than or equal to
   3 :   2/36     35/36      97% will be greater than or equal to
   4 :   3/36     33/36      92% will be greater than or equal to
   5 :   4/36     30/36      83% will be greater than or equal to
   6 :   5/36     26/36      72% will be greater than or equal to
   7 :   6/36     21/36      58% will be greater than or equal to
   8 :   5/36     15/36      42% will be greater than or equal to
   9 :   4/36     10/36      28% will be greater than or equal to
  10 :   3/36      6/36      17% will be greater than or equal to
  11 :   2/36      3/36       8% will be greater than or equal to
  12 :   1/36      1/36       3% will be greater than or equal to

Calculations:
    scout on LEVEL ground:
        need  8 or better to hit LEVEL    enemy   (42%)
        need 10 or better to hit IN COVER enemy   (17%)
        need 11 or better to hit IN COVER grunt   (8%)
        need  6 or better to hit ELEVATED enemy   (72%)
    scout on ELEVATED ground:
        need  7 or better to hit LEVEL    enemy   (58%)
        need  9 or better to hit IN COVER enemy   (28%)
        need 10 or better to hit IN COVER grunt   (17%)
        need  5 or better to hit ELEVATED enemy   (83%)

    grunt on LEVEL ground:
        need  7 or better to hit LEVEL    enemy   (58%)
        need  9 or better to hit IN COVER enemy   (28%)
        need 10 or better to hit IN COVER grunt   (17%)
        need  5 or better to hit ELEVATED enemy   (83%)
    grunt on ELEVATED ground:
        need  6 or better to hit LEVEL    enemy   (72%)
        need  8 or better to hit IN COVER enemy   (42%)
        need  9 or better to hit IN COVER grunt   (28%)
        need  4 or better to hit ELEVATED enemy   (92%)

    sniper on LEVEL ground:
        need  6 or better to hit LEVEL    enemy   (72%)
        need  8 or better to hit IN COVER enemy   (42%)
        need  9 or better to hit IN COVER grunt   (28%)
        need  4 or better to hit ELEVATED enemy   (92%)
    sniper on ELEVATED ground:
        need  5 or better to hit LEVEL    enemy   (83%)
        need  7 or better to hit IN COVER enemy   (58%)
        need  8 or better to hit IN COVER grunt   (42%)
        need  3 or better to hit ELEVATED enemy   (97%)


